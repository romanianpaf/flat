{"ast":null,"code":"import _regeneratorRuntime from\"/home/atria/public_html/f1.atria.live/atria/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"/home/atria/public_html/f1.atria.live/atria/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/home/atria/public_html/f1.atria.live/atria/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import CrudService from\"services/cruds-service\";export var getPermissions=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(id){var res,permissions,jsonPermissions;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return CrudService.getUserWithPermissions(id);case 3:res=_context.sent;permissions=res.included;jsonPermissions=[];permissions.map(function(permission){if(permission.type==\"permissions\"){var namePermission=permission.attributes.name.split(\" \");if(namePermission.length===2){var action=namePermission[0];var subject=namePermission[1];if((action===\"delete\"||action===\"edit\")&&subject===\"users\"){jsonPermissions=[].concat(_toConsumableArray(jsonPermissions),[{action:action,subject:subject,conditions:{id:{$ne:id}}}]);}else{jsonPermissions=[].concat(_toConsumableArray(jsonPermissions),[{action:action,subject:subject}]);}}}});return _context.abrupt(\"return\",jsonPermissions);case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.error(_context.t0);return _context.abrupt(\"return\",null);case 14:case\"end\":return _context.stop();}},_callee,null,[[0,10]]);}));return function getPermissions(_x){return _ref.apply(this,arguments);};}();","map":{"version":3,"names":["CrudService","getPermissions","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","id","res","permissions","jsonPermissions","wrap","_callee$","_context","prev","next","getUserWithPermissions","sent","included","map","permission","type","namePermission","attributes","name","split","length","action","subject","concat","_toConsumableArray","conditions","$ne","abrupt","t0","console","error","stop","_x","apply","arguments"],"sources":["/home/atria/public_html/f1.atria.live/atria/frontend/src/config/Permissions/index.js"],"sourcesContent":["import CrudService from \"services/cruds-service\";\n\nexport const getPermissions = async (id) => {\n  try {\n    const res = await CrudService.getUserWithPermissions(id);\n    const permissions = res.included;\n    let jsonPermissions = [];\n    permissions.map((permission) => {\n      if (permission.type == \"permissions\") {\n        const namePermission = permission.attributes.name.split(\" \");\n        if (namePermission.length === 2) {\n          const action = namePermission[0];\n          const subject = namePermission[1];\n          if ((action === \"delete\" || action === \"edit\") && subject === \"users\") {\n            jsonPermissions = [\n              ...jsonPermissions,\n              { action, subject, conditions: { id: { $ne: id } } },\n            ];\n          } else {\n            jsonPermissions = [...jsonPermissions, { action, subject }];\n          }\n        }\n      }\n    });\n    return jsonPermissions;\n  } catch (err) {\n    console.error(err);\n    return null;\n  }\n};\n"],"mappings":"sbAAA,MAAO,CAAAA,WAAW,KAAM,wBAAwB,CAEhD,MAAO,IAAM,CAAAC,cAAc,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAOC,EAAE,MAAAC,GAAA,CAAAC,WAAA,CAAAC,eAAA,QAAAN,mBAAA,GAAAO,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAF,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA,SAEjB,CAAAf,WAAW,CAACgB,sBAAsB,CAACT,EAAE,CAAC,QAAlDC,GAAG,CAAAK,QAAA,CAAAI,IAAA,CACHR,WAAW,CAAGD,GAAG,CAACU,QAAQ,CAC5BR,eAAe,CAAG,EAAE,CACxBD,WAAW,CAACU,GAAG,CAAC,SAACC,UAAU,CAAK,CAC9B,GAAIA,UAAU,CAACC,IAAI,EAAI,aAAa,CAAE,CACpC,GAAM,CAAAC,cAAc,CAAGF,UAAU,CAACG,UAAU,CAACC,IAAI,CAACC,KAAK,CAAC,GAAG,CAAC,CAC5D,GAAIH,cAAc,CAACI,MAAM,GAAK,CAAC,CAAE,CAC/B,GAAM,CAAAC,MAAM,CAAGL,cAAc,CAAC,CAAC,CAAC,CAChC,GAAM,CAAAM,OAAO,CAAGN,cAAc,CAAC,CAAC,CAAC,CACjC,GAAI,CAACK,MAAM,GAAK,QAAQ,EAAIA,MAAM,GAAK,MAAM,GAAKC,OAAO,GAAK,OAAO,CAAE,CACrElB,eAAe,IAAAmB,MAAA,CAAAC,kBAAA,CACVpB,eAAe,GAClB,CAAEiB,MAAM,CAANA,MAAM,CAAEC,OAAO,CAAPA,OAAO,CAAEG,UAAU,CAAE,CAAExB,EAAE,CAAE,CAAEyB,GAAG,CAAEzB,EAAG,CAAE,CAAE,CAAC,EACrD,CACH,CAAC,IAAM,CACLG,eAAe,IAAAmB,MAAA,CAAAC,kBAAA,CAAOpB,eAAe,GAAE,CAAEiB,MAAM,CAANA,MAAM,CAAEC,OAAO,CAAPA,OAAQ,CAAC,EAAC,CAC7D,CACF,CACF,CACF,CAAC,CAAC,CAAC,OAAAf,QAAA,CAAAoB,MAAA,UACIvB,eAAe,UAAAG,QAAA,CAAAC,IAAA,IAAAD,QAAA,CAAAqB,EAAA,CAAArB,QAAA,aAEtBsB,OAAO,CAACC,KAAK,CAAAvB,QAAA,CAAAqB,EAAI,CAAC,CAAC,OAAArB,QAAA,CAAAoB,MAAA,UACZ,IAAI,2BAAApB,QAAA,CAAAwB,IAAA,MAAA/B,OAAA,iBAEd,kBA3BY,CAAAL,cAAcA,CAAAqC,EAAA,SAAApC,IAAA,CAAAqC,KAAA,MAAAC,SAAA,OA2B1B"},"metadata":{},"sourceType":"module","externalDependencies":[]}