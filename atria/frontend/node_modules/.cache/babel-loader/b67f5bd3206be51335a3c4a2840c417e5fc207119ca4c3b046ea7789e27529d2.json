{"ast":null,"code":"import t, { PureComponent as i, createElement as n } from \"react\";\nconst s = () => {};\nclass e extends i {\n  constructor(...t) {\n    super(...t);\n    this.t = false;\n    this.i = null;\n    this.o = s;\n  }\n  componentWillUnmount() {\n    this.o();\n  }\n  u(t) {\n    if (t === this.i) return;\n    this.o();\n    this.i = null;\n    if (t) {\n      this.i = t;\n      this.o = t.on(\"updated\", () => this.forceUpdate());\n    }\n  }\n  get allowed() {\n    return this.t;\n  }\n  h() {\n    const t = this.props;\n    const i = t.of || t.a || t.an || t.this || t.on;\n    const n = t.not ? \"cannot\" : \"can\";\n    return t.ability[n](t.I || t.do, i, t.field);\n  }\n  render() {\n    this.u(this.props.ability);\n    this.t = this.h();\n    return this.props.passThrough || this.t ? this.l() : null;\n  }\n  l() {\n    const {\n      children: t,\n      ability: i\n    } = this.props;\n    const n = \"function\" === typeof t ? t(this.t, i) : t;\n    return n;\n  }\n}\nfunction r(t) {\n  var i, n;\n  return n = i = class extends e {}, i.defaultProps = {\n    ability: t\n  }, n;\n}\nfunction o(t) {\n  return i => n(t, {\n    children: t => n(e, Object.assign({\n      ability: t\n    }, i))\n  });\n}\nfunction useAbility(i) {\n  if (\"production\" !== process.env.NODE_ENV && \"function\" !== typeof t.useContext) throw new Error(\"You must use React >= 16.8 in order to use useAbility()\");\n  const n = t.useContext(i);\n  const [s, e] = t.useState();\n  t.useEffect(() => n.on(\"updated\", t => {\n    if (t.rules !== s) e(t.rules);\n  }), []);\n  return n;\n}\nexport { e as Can, r as createCanBoundTo, o as createContextualCan, useAbility };","map":{"version":3,"names":["s","noop","e","i","constructor","t","o","componentWillUnmount","u","on","forceUpdate","allowed","h","props","of","a","an","this","n","not","ability","I","do","field","render","passThrough","l","children","r","defaultProps","Object","assign","useAbility","process","env","NODE_ENV","useContext","Error","useState","useEffect","rules","Can","createCanBoundTo","createContextualCan"],"sources":["/home/atria/public_html/f1.atria.live/atria/frontend/node_modules/@casl/react/src/Can.ts","/home/atria/public_html/f1.atria.live/atria/frontend/node_modules/@casl/react/src/factory.ts","/home/atria/public_html/f1.atria.live/atria/frontend/node_modules/@casl/react/src/hooks/useAbility.ts"],"sourcesContent":["import { PureComponent, ReactNode } from 'react';\nimport {\n  Unsubscribe,\n  AbilityTuple,\n  SubjectType,\n  AnyAbility,\n  Generics,\n  Abilities,\n  IfString,\n} from '@casl/ability';\n\nconst noop = () => {};\n\ntype AbilityCanProps<\n  T extends Abilities,\n  Else = IfString<T, { do: T } | { I: T }>\n> = T extends AbilityTuple\n  ? { do: T[0], on: T[1], field?: string } |\n  { I: T[0], a: Extract<T[1], SubjectType>, field?: string } |\n  { I: T[0], an: Extract<T[1], SubjectType>, field?: string } |\n  { I: T[0], this: Exclude<T[1], SubjectType>, field?: string }\n  : Else;\n\ninterface ExtraProps {\n  not?: boolean\n  passThrough?: boolean\n}\n\ninterface CanExtraProps<T extends AnyAbility> extends ExtraProps {\n  ability: T\n  children: ReactNode | ((isAllowed: boolean, ability: T) => ReactNode)\n}\n\ninterface BoundCanExtraProps<T extends AnyAbility> extends ExtraProps {\n  ability?: T\n  children: ReactNode | ((isAllowed: boolean, ability: T) => ReactNode)\n}\n\nexport type CanProps<T extends AnyAbility> =\n  AbilityCanProps<Generics<T>['abilities']> & CanExtraProps<T>;\nexport type BoundCanProps<T extends AnyAbility> =\n  AbilityCanProps<Generics<T>['abilities']> & BoundCanExtraProps<T>;\n\nexport class Can<\n  T extends AnyAbility,\n  IsBound extends boolean = false\n> extends PureComponent<IsBound extends true ? BoundCanProps<T> : CanProps<T>> {\n  private _isAllowed: boolean = false;\n  private _ability: T | null = null;\n  private _unsubscribeFromAbility: Unsubscribe = noop;\n\n  componentWillUnmount() {\n    this._unsubscribeFromAbility();\n  }\n\n  private _connectToAbility(ability?: T) {\n    if (ability === this._ability) {\n      return;\n    }\n\n    this._unsubscribeFromAbility();\n    this._ability = null;\n\n    if (ability) {\n      this._ability = ability;\n      this._unsubscribeFromAbility = ability.on('updated', () => this.forceUpdate());\n    }\n  }\n\n  get allowed() {\n    return this._isAllowed;\n  }\n\n  private _canRender(): boolean {\n    const props: any = this.props;\n    const subject = props.of || props.a || props.an || props.this || props.on;\n    const can = props.not ? 'cannot' : 'can';\n\n    return props.ability[can](props.I || props.do, subject, props.field);\n  }\n\n  render() {\n    this._connectToAbility(this.props.ability);\n    this._isAllowed = this._canRender();\n    return this.props.passThrough || this._isAllowed ? this._renderChildren() : null;\n  }\n\n  private _renderChildren() {\n    const { children, ability } = this.props;\n    const elements = typeof children === 'function'\n      ? children(this._isAllowed, ability as any)\n      : children;\n\n    return elements as ReactNode;\n  }\n}\n","import { createElement as h, ComponentClass, Consumer, FunctionComponent } from 'react';\nimport { AnyAbility } from '@casl/ability';\nimport { Can, BoundCanProps } from './Can';\n\ninterface BoundCanClass<T extends AnyAbility> extends ComponentClass<BoundCanProps<T>> {\n  new (props: BoundCanProps<T>, context?: any): Can<T, true>\n}\n\nexport function createCanBoundTo<T extends AnyAbility>(ability: T): BoundCanClass<T> {\n  return class extends Can<T, true> {\n    static defaultProps = { ability } as BoundCanClass<T>['defaultProps'];\n  };\n}\n\nexport function createContextualCan<T extends AnyAbility>(\n  Getter: Consumer<T>\n): FunctionComponent<BoundCanProps<T>> {\n  return (props: BoundCanProps<T>) => h(Getter, {\n    children: (ability: T) => h(Can, {\n      ability,\n      ...props,\n    } as any)\n  });\n}\n","import React from 'react';\nimport { AnyAbility } from '@casl/ability';\n\nexport function useAbility<T extends AnyAbility>(context: React.Context<T>): T {\n  if (process.env.NODE_ENV !== 'production' && typeof React.useContext !== 'function') {\n    /* istanbul ignore next */\n    throw new Error('You must use React >= 16.8 in order to use useAbility()');\n  }\n\n  const ability = React.useContext<T>(context);\n  const [rules, setRules] = React.useState<T['rules']>();\n\n  React.useEffect(() => ability.on('updated', (event) => {\n    if (event.rules !== rules) {\n      setRules(event.rules);\n    }\n  }), []);\n\n  return ability;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}